<script>
    const changeTheProductImage_{{ block.settings.index }} = () => {
        const card = document.querySelector('#product-card__{{ block.settings.index }}');
        const link = card.querySelector('.product-unit__image');
        const imgs = card.querySelectorAll('img');
        const swatches = card.querySelector('div.product-unit__image-wrapper > div.product-unit__colors > div.product-unit__swatches-container');
        console.log('changeTheProductImage_');
        if(window.innerWidth < 900) {
            {% if block.settings.enable_static_for_mobile == true %}
                [].map.call(imgs, function(img) {
                    img.classList.add('f-loaded');
                });
                swatches.addEventListener('click', function(e) {
                    [].map.call(imgs, function(img) {
                        img.classList.remove('f-loaded');
                    });
                });
            {% else %}
                [].map.call(imgs, function(img) {
                    img.classList.remove('f-loaded');
                });
            {% endif %}
        } else {
            {% if block.settings.enable_static_for_desktop == true %}
                [].map.call(imgs, function(img) {
                    img.classList.add('f-loaded');
                });
                swatches.addEventListener('click', function(e) {
                    [].map.call(imgs, function(img) {
                        img.classList.remove('f-loaded');
                    });
                });
            {% else %}
                [].map.call(imgs, function(img) {
                    img.classList.remove('f-loaded');
                });
            {% endif %}
        }
    }
    window.addEventListener('load', changeTheProductImage_{{ block.settings.index }});
    document.addEventListener("DOMContentLoaded", changeTheProductImage_{{ block.settings.index }});
    window.addEventListener("resize", changeTheProductImage_{{ block.settings.index }});
    document.addEventListener("shopify:section:load", changeTheProductImage_{{ block.settings.index }});
    document.addEventListener("shopify:section:change", changeTheProductImage_{{ block.settings.index }});
    document.addEventListener('page:load', changeTheProductImage_{{ block.settings.index }});
    document.addEventListener('page:change', changeTheProductImage_{{ block.settings.index }});
</script>
<style>
{% if block.settings.enable_static_for_desktop == true %}
    #product-card__{{ block.settings.index }} .product-unit__image > img.f-loaded {
        background-image: url('{{ block.settings.desktop_static_img | image_url}}');
        background-size: cover;
        background-position: center;
        object-position:-1000px;
    }
{% endif %}
{% if block.settings.enable_static_for_mobile == true %}
    @media screen and (max-width:900px){
        #product-card__{{ block.settings.index }} .product-unit__image > img.f-loaded {
            background-image: url('{{ block.settings.mobile_static_img | image_url}}');
        }
    } 
{% endif %}
</style>