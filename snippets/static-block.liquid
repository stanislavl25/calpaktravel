<script>
    const changeTheProductImage_{{ block.settings.index }} = () => {
        const card = document.querySelector('#product-card__{{ block.settings.index }}');
        const link = card.querySelector('.product-unit__image');
        const imgs = card.querySelectorAll('img');
        const swatches = card.querySelector('div.product-unit__image-wrapper > div.product-unit__colors > div.product-unit__swatches-container');
        console.log('changeTheProductImage_{{ block.settings.index }}');
        if(window.innerWidth < 900) {
            {% if block.settings.enable_static_for_mobile == true %}
                // teting1
                {% case block.settings.static_media_type_mobile %}  
                    {% when 'video' %}
                        // teting2
                        {% if block.settings.mobile_static_video %}
                            if(!link.querySelector('.static-video-mobile')) {
                                link.innerHTML += `
                                    <video autoplay muted loop class="static-video-desktop">
                                        <source src="{{- block.settings.mobile_static_video.sources[1].url -}}" type="video/mp4">
                                    </video>
                                `;

                                [].map.call(imgs, function(img) {
                                    img.classList.add('f-loaded');
                                    img.classList.add('d-none');
                                });
                                
                                console.log(link)
                            }
                        {% endif %}
                    {% when 'image' %}
                        {% if block.settings.mobile_static_img %}
                            // teting3
                            [].map.call(imgs, function(img) {
                                img.classList.add('f-loaded');
                            });
                            swatches.addEventListener('click', function(e) {
                                [].map.call(imgs, function(img) {
                                    img.classList.remove('f-loaded');
                                });
                            });
                        {% endif %}
                {% endcase %}
            {% else %}
                [].map.call(imgs, function(img) {
                    img.classList.remove('f-loaded');
                    img.classList.remove('d-none');
                });
            {% endif %}
        } else {
            {% if block.settings.enable_static_for_desktop == true %}
                
                {% case block.settings.static_media_type_desktop %}  
                    {% when 'video' %}
                        {% if block.settings.desktop_static_video %}
                            if(!link.querySelector('.static-video-dektop')) {
                                link.innerHTML += `
                                    <video autoplay muted loop class="static-video-desktop">
                                        <source src="{{- block.settings.desktop_static_video.sources[1].url -}}" type="video/mp4">
                                    </video>
                                `;

                                [].map.call(imgs, function(img) {
                                    img.classList.add('f-loaded');
                                    img.classList.add('d-none');
                                });
                                
                                console.log(link)
                            }
                        {% endif %}
                    {% when 'image' %}
                        {% if block.settings.desktop_static_img %}
                            [].map.call(imgs, function(img) {
                                img.classList.add('f-loaded');
                            });
                            swatches.addEventListener('click', function(e) {
                                [].map.call(imgs, function(img) {
                                    img.classList.remove('f-loaded');
                                });
                            });
                        {% endif %}
                {% endcase %}
            {% else %}
                [].map.call(imgs, function(img) {
                    img.classList.remove('f-loaded');
                    img.classList.remove('d-none');
                });
            {% endif %}
        }
    }
    window.addEventListener('load', changeTheProductImage_{{ block.settings.index }});
    document.addEventListener("DOMContentLoaded", changeTheProductImage_{{ block.settings.index }});
    window.addEventListener("resize", changeTheProductImage_{{ block.settings.index }});
    document.addEventListener("shopify:section:load", changeTheProductImage_{{ block.settings.index }});
    document.addEventListener("shopify:section:change", changeTheProductImage_{{ block.settings.index }});
    document.addEventListener('page:load', changeTheProductImage_{{ block.settings.index }});
    document.addEventListener('page:change', changeTheProductImage_{{ block.settings.index }});
</script>
<style>
{% if block.settings.enable_static_for_desktop == true %}
    #product-card__{{ block.settings.index }} .product-unit__image > .static-video-desktop {
        position: absolute;
        right: 0;
        top: 0;
        width: 100%;
        border-radius: 9px;
        object-fit: cover;
        object-position: center;
        height: 100%;
        z-index: 2;
    }
    #product-card__{{ block.settings.index }} .product-unit__image > img.f-loaded {
        background-image: url('{{ block.settings.desktop_static_img | image_url}}');
        background-size: cover;
        background-position: center;
        object-position:-1000px;
    }
{% endif %}
{% if block.settings.enable_static_for_mobile == true %}
    @media screen and (max-width:900px){
        #product-card__{{ block.settings.index }} .product-unit__image > img.f-loaded {
            background-image: url('{{ block.settings.mobile_static_img | image_url}}');
        }
        #product-card__{{ block.settings.index }} .product-unit__image > .static-video-mobile {
            position: absolute;
            right: 0;
            top: 0;
            width: 100%;
            border-radius: 9px;
            object-fit: cover;
            object-position: center;
            height: 100%;
            z-index: 2;
        }
    } 
{% endif %}


#product-card__{{ block.settings.index }} .product-unit__image > .static-video-mobile {
    display: none;
}
@media screen and (max-width:900px){
    #product-card__{{ block.settings.index }} .product-unit__image > .static-video-desktop {
        display: none;
    }
}
</style>